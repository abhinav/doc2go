{{ define "Head" -}}
<title>{{ .Name }}</title>
{{- /* TODO: For binaries, use the binary name. */ -}}
{{ end -}}

{{ define "Body" -}}
<h2 id="pkg-overview">package {{ .Name }}</h2>
<p><code>import "{{ .ImportPath }}"</code></p>
{{ .Doc | doc }}
{{- /* TODO: package examples */ -}}

<h3 id="pkg-index">Index {{ template "permalink" "pkg-index" }}</h3>
{{ if or .Constants .Variables .Functions .Types -}}
<ul>
  {{ if .Constants }}<li><a href="#pkg-constants">Constants</a></li>{{ end -}}
  {{ if .Variables }}<li><a href="#pkg-variables">Variables</a></li>{{ end -}}
  {{ range .Functions -}}
    <li><a href="#{{ .Name }}">{{ .ShortDecl }}</a></li>
  {{ end -}}
  {{ range $typ := .Types -}}
    <li>
      <a href="#{{ .Name }}">type {{ .Name }}</a>
      {{ if or .Functions .Methods -}}
        <ul>
          {{ range .Functions -}}
            <li><a href="#{{ .Name }}">{{ .ShortDecl }}</a></li>
          {{ end -}}
          {{ range .Methods -}}
            <li><a href="#{{ $typ.Name }}.{{ .Name }}">{{ .ShortDecl }}</a></li>
          {{ end -}}
        </ul>
      {{ end -}}
    </li>
  {{ end -}}
</ul>
{{- end }}

{{- /* TODO: all examples */ -}}

{{ with .Constants -}}
  <h3 id="pkg-constants">Constants {{ template "permalink" "pkg-constants" }}</h3>
  {{ range . }}{{ template "constOrVar" . }}{{ end -}}
{{ end -}}

{{ with .Variables -}}
  <h3 id="pkg-variables">Variables {{ template "permalink" "pkg-variables" }}</h3>
  {{ range . }}{{ template "constOrVar" . }}{{ end -}}
{{ end -}}

{{ with .Functions -}}
  <h3 id="pkg-functions">Functions {{ template "permalink" "pkg-functions" }}</h3>
  {{ range . -}}
    <h3 id="{{ .Name }}">func {{ .Name }} {{ template "permalink" .Name }}</h3>
    <pre><code>{{ .Decl | code }}</code></pre>
    {{ .Doc | doc -}}
    {{- /* TODO: function examples */ -}}
  {{ end -}}
{{ end -}}

{{ with .Types -}}
  <h3 id="pkg-types">Types {{ template "permalink" "pkg-types" }}</h3>
  {{ range . -}}
  <h3 id="{{ .Name }}">type {{ .Name }} {{ template "permalink" .Name }}</h3>
    <pre><code>{{ .Decl | code }}</code></pre>
    {{ .Doc | doc -}}
    {{- /* TODO: type examples */ -}}

    {{ range .Constants -}}
      {{ template "constOrVar" . -}}
    {{ end -}}

    {{ range .Variables -}}
      {{ template "constOrVar" . -}}
    {{ end -}}

    {{ range .Functions -}}
      {{ template "funcOrMethod" . -}}
    {{ end -}}

    {{ range .Methods -}}
      {{ template "funcOrMethod" . -}}
    {{ end -}}
  {{ end -}}
{{ end -}}

{{ if .Subpackages -}}
  {{ template "subpackages.html" . -}}
{{ end -}}
{{ end -}}

{{- define "constOrVar" -}}
  <pre><code>{{ .Decl | code }}</code></pre>
  {{ .Doc | doc -}}
{{- end -}}

{{- define "funcOrMethod" -}}
  {{ $id := .Name -}}
  {{ with .RecvType }}{{ $id = printf "%s.%s" . $id }}{{ end -}}
  <h4 id="{{ $id }}">
    func {{ with .Recv }}({{ . }}) {{end }}{{ .Name }} {{ template "permalink" $id }}
  </h4>
  <pre><code>{{ .Decl | code }}</code></pre>
  {{ .Doc | doc -}}
  {{- /* TODO: function examples */ -}}
{{- end -}}

{{- define "permalink" -}}
  <a class="permalink" href="#{{ . }}">&para;</a>
{{- end -}}
